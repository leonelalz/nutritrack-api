# üìú REGLAS DE NEGOCIO - NUTRITRACK

> **Documento Fundacional del Proyecto**  
> Este documento establece las 24 reglas de negocio que DEBEN implementarse en el sistema NutriTrack.  
> Sirve como gu√≠a de desarrollo para cada integrante del equipo.

---

## üìä DISTRIBUCI√ìN DE RESPONSABILIDADES

### Asignaci√≥n de Reglas por Integrante

| M√≥dulo | Responsable | Reglas Asignadas | Prioridad Cr√≠tica |
|--------|-------------|------------------|-------------------|
| **M√≥dulo 1: Gesti√≥n de Cuentas y Perfil** | Leonel Alzamora | RN01 - RN05 (5 reglas) | - |
| **M√≥dulo 2: Biblioteca de Contenido** | Fabian Rojas | RN06 - RN10 (5 reglas) | RN07, RN08, RN09 üî¥ |
| **M√≥dulo 3: Gestor de Cat√°logo** | Jhamil Pe√±a | RN11 - RN14 (4 reglas) | RN14 üü° |
| **M√≥dulo 4: Exploraci√≥n y Activaci√≥n** | Gonzalo Huaranga | RN15 - RN17 (3 reglas) | RN16 üö®üî¥ |
| **M√≥dulo 4: Exploraci√≥n y Activaci√≥n** | Victor Carranza | RN18 - RN19 (2 reglas) | - |
| **M√≥dulo 5: Seguimiento de Progreso** | Leonel Alzamora | RN20 - RN24 (5 reglas) | - |
| **TOTAL** | **Equipo Completo** | **24 reglas** | **5 cr√≠ticas** |

### üö® Reglas de Implementaci√≥n Cr√≠tica (Prioridad M√°xima)

Estas reglas deben implementarse PRIMERO por riesgo de seguridad o integridad de datos:

1. üö® **RN16** - Filtrar cat√°logo por alergias del usuario (**SEGURIDAD DE SALUD** - Gonzalo Huaranga)
2. üî¥ **RN07** - Ingredientes/Ejercicios con nombre √∫nico (**INTEGRIDAD** - Fabian Rojas)
3. üî¥ **RN08** - No eliminar etiquetas en uso (**INTEGRIDAD** - Fabian Rojas)
4. üî¥ **RN09** - No eliminar ingredientes/ejercicios en uso (**INTEGRIDAD** - Fabian Rojas)
5. üü° **RN14** - No eliminar plan si tiene usuarios activos (**CONSISTENCIA** - Jhamil Pe√±a)

---

## üìã M√ìDULO 1: GESTI√ìN DE CUENTAS Y PERFIL
**Responsable:** Leonel Alzamora

### RN01 - Email √∫nico en `cuentas_auth`
- **Regla:** Un usuario no puede crear m√°s de una cuenta con el mismo correo electr√≥nico (el email debe ser UNIQUE en cuentas_auth).
- **Historia de Usuario:** US-01 ‚Äì Crear cuenta
- **Responsable:** Leonel Alzamora
- **Implementaci√≥n Requerida:**
  - Constraint en JPA: `@Column(unique = true)` en `CuentaAuth.email`
  - Constraint en SQL: `UNIQUE` en tabla `cuentas_auth`
  - Validaci√≥n en Service: Verificar email no existe antes de crear cuenta

### RN02 - Login falla si credenciales incorrectas o cuenta inactiva
- **Regla:** El inicio de sesi√≥n debe fallar si las credenciales son incorrectas o si la cuenta tiene el estado = 'inactivo'.
- **Historia de Usuario:** US-02 ‚Äì Iniciar Sesi√≥n
- **Responsable:** Leonel Alzamora
- **Implementaci√≥n Requerida:**
  - Validar contrase√±a con BCrypt en `AuthService.login()`
  - Verificar `cuentaAuth.activo == true` antes de generar token JWT
  - Retornar HTTP 401 si credenciales incorrectas o cuenta inactiva

### RN03 - Unidad de medida aplica a todas las vistas
- **Regla:** La unidad de medida (ej. "kg" o "lbs") seleccionada por el usuario debe aplicarse a todas las vistas donde se muestre peso.
- **Historia de Usuario:** US-03 ‚Äì Configurar unidades de medida
- **Responsable:** Leonel Alzamora
- **Implementaci√≥n Requerida:**
  - Campo `perfiles_usuario.unidades_medida` (ENUM: KG/LBS)
  - DTOs de respuesta deben convertir peso seg√∫n preferencia del usuario
  - Guardar SIEMPRE en KG en base de datos, convertir solo en presentaci√≥n

### RN04 - Perfil salud usa etiquetas maestras
- **Responsable:** Leonel Alzamora
- **Implementaci√≥n Requerida:**
  - Tabla `usuario_etiquetas_salud` con FK a `etiquetas` y FK a `perfiles_usuario`
  - Solo permitir seleccionar etiquetas existentes (validaci√≥n en Service)
  - Categor√≠as: objetivos, alergias, condiciones m√©dicasAlzamora
- **Implementaci√≥n:** `usuario_etiquetas_salud` FK a tabla `etiquetas`
- **Estado:** ‚úÖ **CUMPLE**

### RN05 - Eliminaci√≥n requiere confirmaci√≥n expl√≠cita
- **Responsable:** Leonel Alzamora
- **Implementaci√≥n Requerida:**
```javaado:** ‚ö†Ô∏è **PARCIAL** (confirmaci√≥n solo en frontend, falta validaci√≥n en backend)
- **Acci√≥n Requerida:**
```java
@DeleteMapping("/cuenta")
public ResponseEntity<?> eliminarCuenta(
    @RequestParam String confirmacion // Usuario debe escribir "ELIMINAR"
) {
    if (!"ELIMINAR".equals(confirmacion)) {
        throw new BadRequestException("Texto de confirmaci√≥n incorrecto");
    }
    // Proceder con eliminaci√≥n
}
```

---

## üìö M√ìDULO 2: BIBLIOTECA DE CONTENIDO - ADMIN
**Responsable:** Fabian Rojas

### RN06 - Etiquetas con nombre √∫nico
- **Regla:** No pueden existir dos etiquetas con el mismo nombre (restricci√≥n UNIQUE).
- **Historia de Usuario:** US-06 ‚Äì Gestionar Etiquetas
- **Responsable:** Fabian Rojas
- **Implementaci√≥n Requerida:**
  - Constraint en JPA: `@Column(unique = true)` en `Etiqueta.nombre`
  - Constraint en SQL: `UNIQUE` en tabla `etiquetas`

### RN07 - Ingredientes/Ejercicios con nombre √∫nico
- **Regla:** No pueden existir dos ingredientes o ejercicios con el mismo nombre (restricci√≥n UNIQUE).
- **Historias de Usuario:** US-07 ‚Äì Gestionar Ingredientes, US-08 ‚Äì Gestionar Ejercicios
- **Responsable:** Fabian Rojas
- **Responsable:** Fabian Rojas
- **Prioridad:** üî¥ **CR√çTICA**
- **Implementaci√≥n Requerida:**
```sqlTABLE ingredientes ADD CONSTRAINT uk_ingredientes_nombre UNIQUE (nombre);
ALTER TABLE ejercicios ADD CONSTRAINT uk_ejercicios_nombre UNIQUE (nombre);
```

### RN08 - No eliminar etiqueta si est√° en uso
- **Regla:** El sistema debe impedir la eliminaci√≥n (DELETE) de una etiqueta si esta est√° siendo usada (en etiquetas_ingredientes, etiquetas_metas, etc.).
- **Historia de Usuario:** US-06 ‚Äì Gestionar Etiquetas
- **Responsable:** Fabian Rojas
- **Implementaci√≥n:** No implementado - falta validaci√≥n en `EtiquetaService.eliminar()`
- **Responsable:** Fabian Rojas
- **Prioridad:** üî¥ **CR√çTICA**
- **Implementaci√≥n Requerida:**
  - Query en `EtiquetaRepository` para verificar si est√° en uso
  - Verificar en: `plan_etiquetas`, `rutina_etiquetas`, `usuario_etiquetas_salud`, `ingrediente_etiquetas`, `ejercicio_etiquetas`
  - Si est√° en uso, retornar HTTP 409 Conflict con mensaje claro
- **Regla:** El sistema debe impedir la eliminaci√≥n de un ingrediente o ejercicio si este est√° siendo usado en una receta o catalogo_rutinas.
- **Historias de Usuario:** US-07 ‚Äì Gestionar Ingredientes, US-08 ‚Äì Gestionar Ejercicios
- **Responsable:** Fabian Rojas
- **Implementaci√≥n:** No implementado - falta validaci√≥n en servicios
- **Responsable:** Fabian Rojas
- **Prioridad:** üî¥ **CR√çTICA**
- **Implementaci√≥n Requerida:**
  - Validar ingrediente no est√° en `comida_ingredientes` antes de eliminar
  - Validar ejercicio no est√° en `rutina_ejercicios` antes de eliminar
  - Retornar HTTP 409 Conflict si est√° en uso
- **Regla:** Al crear recetas, la cantidad_ingrediente debe validarse como un valor num√©rico positivo.
- **Historia de Usuario:** US-10 ‚Äì Gestionar Recetas
- **Responsable:** Fabian Rojas
- **Implementaci√≥n:** SQL: `NUMERIC(5,2) NOT NULL`, validaci√≥n en DTO con `@Positive`
- **Estado:** ‚úÖ **CUMPLE**
- **Responsable:** Fabian Rojas
- **Implementaci√≥n Requerida:**
  - Campo SQL: `cantidad NUMERIC(5,2) NOT NULL`
  - DTO con validaci√≥n: `@Positive` y `@NotNull`
  - Rechazar valores negativos o cero
## üóÇÔ∏è M√ìDULO 3: GESTOR DE CAT√ÅLOGO - ADMIN
**Responsable:** Jhamil Pe√±a

### RN11 - Nombres √∫nicos en `catalogo_metas`
- **Regla:** No pueden existir dos catalogo_metas con el mismo nombre (restricci√≥n UNIQUE).
- **Historia de Usuario:** US-11 ‚Äì Crear Meta del Cat√°logo
- **Responsable:** Jhamil Pe√±a
- **Nota:** En la implementaci√≥n, `catalogo_metas` corresponde a tablas `planes` y `rutinas`
- **Implementaci√≥n Requerida:**
```sql
ALTER TABLE planes ADD CONSTRAINT uk_planes_nombre UNIQUE (nombre);
ALTER TABLE rutinas ADD CONSTRAINT uk_rutinas_nombre UNIQUE (nombre);
```

### RN12 - Solo asignar etiquetas existentes
- **Regla:** El sistema solo debe permitir asignar etiquetas a una meta (etiquetas_metas) si estas ya existen en la tabla etiquetas.
- **Historia de Usuario:** US-12 ‚Äì Gestionar Meta
- **Responsable:** Jhamil Pe√±a
- **Implementaci√≥n Requerida:**
  - FK en tabla `plan_etiquetas` ‚Üí `etiquetas.id`
  - FK en tabla `rutina_etiquetas` ‚Üí `etiquetas.id`
  - Validar que etiqueta existe antes de asignar

### RN13 - Series y repeticiones num√©ricas positivas
- **Regla:** Al ensamblar una catalogo_rutinas, los campos series y repeticiones deben validarse como valores num√©ricos enteros y positivos.
- **Historia de Usuario:** US-14 ‚Äì Ensamblar Rutinas
- **Responsable:** Jhamil Pe√±a
- **Implementaci√≥n Requerida:**
  - Campos SQL: `series INTEGER NOT NULL`, `repeticiones INTEGER NOT NULL`
  - Validaci√≥n DTO: `@Positive @NotNull`
  - Rechazar valores negativos o cero

### RN14 - No eliminar meta si tiene clientes activos
- **Regla:** El sistema debe impedir la eliminaci√≥n (DELETE) de una catalogo_metas si esta tiene clientes activos (estado = 'activo' en usuario_metas_asignadas).
- **Historia de Usuario:** US-15 ‚Äì Eliminar Meta
- **Responsable:** Jhamil Pe√±a
- **Prioridad:** üü° **ALTA**
- **Implementaci√≥n Requerida:**
```java
@Service
public class PlanService {
    public void eliminar(Long id) {
        long usuariosActivos = usuarioPlanRepository
            .countByPlanIdAndEstado(id, EstadoAsignacion.ACTIVO);
        
## üîç M√ìDULO 4: EXPLORACI√ìN Y ACTIVACI√ìN - CLIENTE
**Responsables:** Gonzalo Huaranga (RN15-RN17), Victor Carranza (RN18-RN19)

### RN15 - Cat√°logo muestra metas sugeridas seg√∫n perfil
- **Regla:** La vista del "Cat√°logo" debe mostrar metas sugeridas (basadas en etiquetas) si el usuario_perfil_salud existe; de lo contrario, debe mostrar la lista general.
- **Historia de Usuario:** US-16 ‚Äì Ver Cat√°logo (Cliente)
- **Responsable:** Gonzalo Huaranga
- **Implementaci√≥n Requerida:**
  - Endpoint `GET /api/v1/planes/catalogo?sugeridos=true`
  - Query que filtre por etiquetas de `usuario_perfil_salud.objetivo_actual`
  - Si usuario no tiene perfil, mostrar lista completa

### RN16 - Ocultar del cat√°logo planes con al√©rgenos del usuario
- **Regla:** El sistema debe OCULTAR del cat√°logo (US-16) cualquier meta que contenga ingredientes o ejercicios que choquen con las etiquetas de alergia o condici√≥n del usuario_perfil_salud.
- **Historias de Usuario:** US-16 ‚Äì Ver Cat√°logo (Cliente), US-04 ‚Äì Editar perfil de salud
- **Responsable:** Gonzalo Huaranga
- **Prioridad:** üö® **CR√çTICA - SEGURIDAD DE SALUD**
- **Implementaci√≥n Requerida:**
  - Query que identifique ingredientes/ejercicios con etiquetas de alergia del usuario
  - Excluir planes que contengan esos ingredientes del cat√°logo
  - Ejemplo: Usuario al√©rgico a "Nueces" NO ve planes con ingredientes etiquetados "Nueces"

### RN17 - No duplicar el mismo plan/rutina activo
- **Regla:** Un usuario NO puede activar el MISMO plan o rutina si ya lo tiene ACTIVO. Puede tener m√∫ltiples planes/rutinas diferentes activos simult√°neamente, pero no duplicados del mismo.
- **Historia de Usuario:** US-18 ‚Äì Activar una Meta
- **Responsable:** Gonzalo Huaranga
- **Prioridad:** üü° **ALTA**
- **Implementaci√≥n Requerida:**
```java
// Para PLANES
Optional<UsuarioPlan> mismoPlanActivo = usuarioPlanRepository
    .findByPerfilUsuarioIdAndPlanIdAndEstado(
        perfilId, 
        planId, 
        EstadoAsignacion.ACTIVO
    );

if (mismoPlanActivo.isPresent()) {
    throw new BusinessException(
        "Ya tienes este plan activo. Debes pausarlo/cancelarlo para reiniciarlo."
    );
}

// Para RUTINAS
Optional<UsuarioRutina> mismaRutinaActiva = usuarioRutinaRepository
    .findByPerfilUsuarioIdAndRutinaIdAndEstado(
        perfilId, 
        rutinaId, 
        EstadoAsignacion.ACTIVO
    );

if (mismaRutinaActiva.isPresent()) {
    throw new BusinessException(
        "Ya tienes esta rutina activa. Debes pausarla/cancelarla para reiniciarla."
    );
}
```

**Escenarios v√°lidos:**
- ‚úÖ Plan A (ACTIVO) + Plan B (ACTIVO) ‚Üí Diferentes planes OK
- ‚úÖ Rutina X (ACTIVO) + Rutina Y (ACTIVO) ‚Üí Diferentes rutinas OK
- ‚úÖ Plan A (ACTIVO) + Plan A (PAUSADO) ‚Üí Mismo plan, diferente estado OK
- ‚ùå Plan A (ACTIVO) + Plan A (ACTIVO) ‚Üí Duplicado NO permitido

### RN18 - Proponer reemplazo al activar el mismo plan/rutina
- **Regla:** Si un usuario intenta activar el MISMO plan/rutina que ya tiene ACTIVO, el sistema debe proponer pausarlo/cancelarlo primero y luego reiniciarlo.
- **Historia de Usuario:** US-18 ‚Äì Activar una Meta
- **Responsable:** Victor Carranza
- **Prioridad:** üü° **ALTA**
- **Implementaci√≥n Requerida:**
  - Endpoint debe verificar duplicados seg√∫n RN17
  - Si existe, retornar HTTP 409 Conflict con mensaje espec√≠fico
  - Frontend debe mostrar di√°logo: "Ya tienes este plan activo en el d√≠a X. ¬øDeseas pausarlo y reiniciarlo desde el d√≠a 1?"
  - Si usuario acepta: pausar instancia actual, crear nueva instancia como ACTIVO

### RN19 - No pausar/reanudar meta completada/cancelada
- **Regla:** Un cliente no puede "Pausar" o "Reanudar" una meta que ya est√° en un estado final ('completado' o 'cancelado').
- **Historia de Usuario:** US-19 ‚Äì Pausar/Reanudar Meta
- **Responsable:** Victor Carranza
- **Implementaci√≥n Requerida:**
  - Validar que estado actual sea ACTIVO o PAUSADO antes de cambiar
  - Si estado es COMPLETADO o CANCELADO, retornar HTTP 400 Bad Request
  - Transiciones permitidas: ACTIVO ‚Üî PAUSADO
}
```

### RN18 - Proponer reemplazo al activar nueva meta
## üìà M√ìDULO 5: SEGUIMIENTO DE PROGRESO - CLIENTE
**Responsable:** Leonel Alzamora

### RN20 - Mostrar checks en actividades completadas
- **Regla:** La lista de "Mi Plan" (US-21) debe mostrar visualmente (ej. con un check) las catalogo_actividades que ya tienen un registro en usuario_actividades_progreso.
- **Historia de Usuario:** US-21 ‚Äì Ver Actividades de mi Plan
- **Responsable:** Leonel Alzamora
- **Nota:** El sistema usa `registros_comidas` y `registros_ejercicios` (no checklist de actividades)
- **Implementaci√≥n Requerida:**
  - DTO de respuesta debe incluir campo `completado: boolean`
  - Marcar `completado=true` si existe registro para esa fecha
  - Frontend muestra √≠cono visual (‚úì) en actividades completadas

### RN21 - No marcar actividad si plan pausado
- **Regla:** Un cliente no puede marcar una actividad como 'completada' si su meta asignada est√° estado = 'pausado'.
- **Historias de Usuario:** US-22 ‚Äì Marcar Actividad como Completada, US-21 ‚Äì Ver Actividades
- **Responsable:** Leonel Alzamora
- **Implementaci√≥n Requerida:**
  - `RegistroComidaService` debe validar estado del plan antes de crear registro
  - `RegistroEjercicioService` debe validar estado del plan antes de crear registro
  - Si estado = PAUSADO, retornar HTTP 400 Bad Request con mensaje claro

### RN22 - Validar mediciones num√©ricas en rango
- **Regla:** El registro de una nueva medici√≥n (usuario_historial_medidas) debe validarse como num√©rico y dentro de un rango realista (ej. > 0 y < 600).
- **Historia de Usuario:** US-24 ‚Äì Registrar y Ver Mediciones
- **Responsable:** Leonel Alzamora
- **Implementaci√≥n Requerida:**
```java
@DecimalMin(value = "20.0", message = "El peso debe ser mayor a 20 kg")
@DecimalMax(value = "600.0", message = "El peso debe ser menor a 600 kg")
private BigDecimal peso;

@DecimalMin(value = "50.0", message = "La altura debe ser mayor a 50 cm")
@DecimalMax(value = "300.0", message = "La altura debe ser menor a 300 cm")
private BigDecimal altura;
```

### RN23 - Gr√°fico requiere 2+ registros
- **Regla:** El gr√°fico de progreso (evoluci√≥n de peso) solo debe generarse si existen 2 o m√°s registros en usuario_historial_medidas para ese cliente.
- **Historia de Usuario:** US-25 ‚Äì Ver Gr√°fico de Progreso
- **Responsable:** Leonel Alzamora
- **Implementaci√≥n Requerida:**
  - Query `COUNT(*)` en `usuario_historial_medidas` por usuario
  - Si count < 2, retornar HTTP 400 Bad Request
  - Mensaje: "Se necesitan al menos 2 mediciones para generar el gr√°fico"

### RN24 - Reporte PDF con datos del usuario
- **Regla:** El reporte PDF debe generarse con los datos del usuario (progreso, mediciones) y estar en un formato est√°ndar legible.
- **Historia de Usuario:** US-25 ‚Äì Ver Gr√°fico de Progreso y Reporte
- **Responsable:** Leonel Alzamora
- **Prioridad:** üü° **MEDIA**
- **Implementaci√≥n Requerida:**
  - Librer√≠a: iText o Apache PDFBox
  - Endpoint: `GET /api/v1/progreso/reporte/pdf`
  - Incluir: datos del usuario, gr√°fico de peso, resumen de actividades completadas
  - Formato: PDF/A est√°ndar, m√°ximo 5 MBbe ser menor a 300 cm")
private BigDecimal altura;
```

### RN23 - Gr√°fico requiere 2+ registros
- **User Story:** US-25
- **Implementaci√≥n:** Validaci√≥n en frontend/servicio
- **Estado:** ‚úÖ **CUMPLE**

### RN24 - Reporte PDF con datos del usuario
- **User Story:** US-25
- **Implementaci√≥n:** No implementado - pendiente
- **Estado:** ‚ùå **NO CUMPLE**
- **Impacto:** Usuario no puede exportar su progreso

---

## üéØ REGLAS TRANSVERSALES

Estas reglas aplican a TODOS los m√≥dulos del sistema.

### RN25 - Integridad Nutricional (C√°lculo Autom√°tico)

**Regla:** Las calor√≠as consumidas DEBEN calcularse autom√°ticamente, NUNCA entrada manual.

**F√≥rmula de C√°lculo:**
```
calorias_consumidas = SUM(
    ingrediente.energia * 
    receta.cantidad_ingrediente / 100 * 
    registro.porciones
) FOR ALL ingredientes IN comida
```

**Implementaci√≥n Requerida:**
- Service layer calcula calor√≠as basado en ingredientes
- No permitir campo manual de calor√≠as en DTOs de registro
- Recalcular si usuario cambia cantidad de porciones

---

### RN26 - Estado de Asignaciones (Transiciones V√°lidas)

**Estados permitidos:** `ACTIVO | COMPLETADO | CANCELADO | PAUSADO`

**Transiciones V√°lidas:**
- ‚úÖ `ACTIVO ‚Üí COMPLETADO` (al llegar a duracion_dias)
- ‚úÖ `ACTIVO ‚Üí CANCELADO` (usuario abandona)
- ‚úÖ `ACTIVO ‚Üí PAUSADO` (usuario pausa temporalmente)
- ‚úÖ `PAUSADO ‚Üí ACTIVO` (usuario reanuda)

**Transiciones PROHIBIDAS:**
- ‚ùå `COMPLETADO ‚Üí ACTIVO` (no reactivar plan completado)
- ‚ùå `CANCELADO ‚Üí ACTIVO` (crear nueva asignaci√≥n en su lugar)
- ‚ùå `COMPLETADO ‚Üí PAUSADO` (no tiene sentido)
- ‚ùå `CANCELADO ‚Üí PAUSADO` (no tiene sentido)

**Implementaci√≥n Requerida:**
- Validar transici√≥n antes de cambiar estado
- Retornar HTTP 400 si transici√≥n inv√°lida
- Enum con m√°quina de estados en Service

---

### RN27 - Unidades de Medida Consistentes

**Regla:** TODO peso/altura debe almacenarse en KG/CM en base de datos (unidad est√°ndar).

**Flujo de Conversi√≥n:**
1. **Input:** Usuario env√≠a en su unidad preferida (KG o LBS)
2. **Storage:** Convertir a KG/CM para almacenar
3. **Output:** Convertir de KG/CM a unidad preferida del usuario

**Implementaci√≥n Requerida:**
- M√©todos utilitarios: `convertirAKg()`, `convertirDesdeLbs()`, etc.
- DTOs aceptan valor + unidad
- Base de datos solo KG/CM
- Response DTOs usan preferencia del usuario

---

### RN28 - Soft Delete para Planes y Rutinas

**Regla:** Planes y rutinas NO se eliminan f√≠sicamente (DELETE), se marcan como inactivos (UPDATE).

**Implementaci√≥n Requerida:**
```java
// NO hacer esto:
planRepository.deleteById(id);

// Hacer esto:
plan.setActivo(false);
planRepository.save(plan);
```

**Raz√≥n:** Preservar historial de usuarios que usaron el plan, incluso si el admin lo "elimina".

**Consultas:** Filtrar por `activo = true` en queries p√∫blicas.

---

## üîí REGLAS DE SEGURIDAD Y PROTECCI√ìN

### RN29 - Rate Limiting para Protecci√≥n DDoS
- **Regla:** El sistema debe limitar la cantidad de peticiones por usuario/IP para prevenir ataques de denegaci√≥n de servicio (DDoS) y brute force en endpoints cr√≠ticos.
- **M√≥dulos Afectados:** M√≥dulo 1 (Autenticaci√≥n)
- **Prioridad:** üö® **CR√çTICA - SEGURIDAD**
- **Implementaci√≥n Requerida:**
```java
// Configuraci√≥n con Spring Cloud Resilience4j
@Configuration
public class RateLimitConfig {
    @Bean
    public RateLimiter loginRateLimiter() {
        return RateLimiter.of("login", RateLimiterConfig.custom()
            .limitRefreshPeriod(Duration.ofMinutes(1))
            .limitForPeriod(5) // 5 intentos por minuto
            .timeoutDuration(Duration.ofSeconds(0))
            .build());
    }
}

@PostMapping("/login")
@RateLimiter(name = "login", fallbackMethod = "loginFallback")
public ResponseEntity<?> login(@RequestBody LoginRequest request) {
    // L√≥gica de login
}

public ResponseEntity<?> loginFallback(Exception e) {
    return ResponseEntity.status(429)
        .body("Demasiados intentos de login. Intenta de nuevo en 1 minuto.");
}
```
- **L√≠mites Recomendados:**
  - Login: 5 intentos/minuto por IP
  - Registro: 3 intentos/minuto por IP
  - Endpoints generales: 100 requests/minuto por usuario autenticado
- **Estado:** ‚ùå **NO IMPLEMENTADO**

### ‚úÖ RN30 - Validaci√≥n de Formato de Email
- **Regla:** El sistema debe validar que el email proporcionado tiene un formato v√°lido RFC 5322 antes de crear una cuenta.
- **M√≥dulos Afectados:** M√≥dulo 1 (Gesti√≥n de Cuentas)
- **Prioridad:** üî¥ **ALTA - SEGURIDAD**
- **Implementaci√≥n:**
  - Regex RFC 5322 en `RegisterRequest.email` con anotaci√≥n `@Email`
  - M√©todo `validarEmail()` en `AuthService` con verificaci√≥n DNS usando `InetAddress.getByName()`
  - Validaci√≥n ejecutada antes de crear cuenta en `register()`
- **Ubicaci√≥n:** `dto/auth/RegisterRequest.java`, `service/AuthService.java`
- **Estado:** ‚úÖ **IMPLEMENTADO** (Noviembre 2025)

### ‚úÖ RN31 - Pol√≠tica de Contrase√±as Robusta
- **Regla:** Las contrase√±as deben cumplir con est√°ndares de seguridad robustos para prevenir cuentas vulnerables.
- **M√≥dulos Afectados:** M√≥dulo 1 (Gesti√≥n de Cuentas)
- **Prioridad:** üö® **CR√çTICA - SEGURIDAD**
- **Implementaci√≥n:**
  - Regex pattern en `RegisterRequest.password` con `@Pattern` y `@Size(min=12)`
  - Requisitos: 12+ caracteres, may√∫scula, min√∫scula, n√∫mero, s√≠mbolo especial
  - M√©todo `validarPasswordSegura()` en `AuthService` que verifica:
    - No contrase√±as comunes (blacklist)
    - No contiene email del usuario
  - Lista blacklist: "password1234", "admin1234567", "123456789012", "qwerty123456", "letmein12345"
- **Ubicaci√≥n:** `dto/auth/RegisterRequest.java`, `service/AuthService.java`
- **Estado:** ‚úÖ **IMPLEMENTADO** (Noviembre 2025)

---

## üõ°Ô∏è REGLAS DE INTEGRIDAD DE DATOS

### ‚úÖ RN32 - Validaci√≥n Cruzada de Al√©rgenos en Asignaci√≥n
- **Regla:** Cuando un usuario activa un plan, el sistema debe validar que el plan NO contenga ingredientes con etiquetas de al√©rgenos del perfil de salud del usuario.
- **M√≥dulos Afectados:** M√≥dulo 4 (Exploraci√≥n y Activaci√≥n)
- **Prioridad:** üö® **CR√çTICA - SEGURIDAD DE SALUD**
- **Implementaci√≥n:**
  - M√©todo `validarAlergenosUsuario()` en `UsuarioPlanService` ejecutado antes de activar plan
  - Query `findEtiquetasAlergenosByPerfilUsuarioId()` en `UsuarioEtiquetasSaludRepository` para obtener alergias del usuario
  - Query `findEtiquetasIngredientesByPlanId()` en `PlanRepository` usando 5-join query:
    ```
    Plan ‚Üí PlanDia ‚Üí Comida ‚Üí ComidaIngrediente ‚Üí Ingrediente ‚Üí Etiqueta
    ```
  - Validaci√≥n por intersecci√≥n de conjuntos (alergias usuario ‚à© etiquetas ingredientes plan)
  - Si hay coincidencias, lanza `BusinessException` con nombres de al√©rgenos usando `EtiquetaRepository.findNombresByIds()`
  - Previene activaci√≥n de planes incompatibles con salud del usuario
- **Ubicaci√≥n:** 
  - `service/UsuarioPlanService.java`
  - `repository/UsuarioEtiquetasSaludRepository.java`
  - `repository/PlanRepository.java`
  - `repository/EtiquetaRepository.java`
- **Estado:** ‚úÖ **IMPLEMENTADO** (Noviembre 2025)

### RN33 - Validaci√≥n L√≥gica de Fechas en Registros
- **Regla:** Los registros de progreso (comidas, ejercicios, mediciones) deben validar que la fecha no sea futura y sea posterior o igual a la fecha de inicio del plan activo.
- **M√≥dulos Afectados:** M√≥dulo 5 (Seguimiento de Progreso)
- **Prioridad:** üî¥ **ALTA - INTEGRIDAD**
- **Implementaci√≥n Requerida:**
```java
@Service
public class RegistroComidaService {
    
    public void registrarComida(RegistroComidaRequest request, Long perfilUsuarioId) {
        LocalDate fechaRegistro = request.getFecha();
        LocalDate hoy = LocalDate.now();
        
        // 1. No permitir fechas futuras
        if (fechaRegistro.isAfter(hoy)) {
            throw new ValidationException(
                "No puedes registrar comidas en el futuro. Fecha m√°xima: " + hoy
            );
        }
        
        // 2. Verificar que fecha est√© dentro del rango del plan activo
        UsuarioPlan planActivo = usuarioPlanRepository
            .findActivoByPerfilUsuarioId(perfilUsuarioId)
            .orElseThrow(() -> new BusinessException("No tienes un plan activo"));
        
        LocalDate inicioPlan = planActivo.getFechaInicio();
        if (fechaRegistro.isBefore(inicioPlan)) {
            throw new ValidationException(
                "La fecha del registro debe ser posterior al inicio de tu plan (" 
                + inicioPlan + ")"
            );
        }
        
        // 3. Validar que no hayan pasado m√°s d√≠as de la duraci√≥n del plan
        int diasTranscurridos = (int) ChronoUnit.DAYS.between(inicioPlan, fechaRegistro);
        if (diasTranscurridos >= planActivo.getPlan().getDuracionDias()) {
            throw new ValidationException(
                "Tu plan tiene duraci√≥n de " + planActivo.getPlan().getDuracionDias() 
                + " d√≠as. Este registro excede la duraci√≥n."
            );
        }
        
        // Proceder con registro...
    }
}
```
- **Validaciones DTO:**
```java
@PastOrPresent(message = "La fecha no puede ser futura")
@NotNull(message = "La fecha es obligatoria")
private LocalDate fecha;
```
- **Estado:** ‚ö†Ô∏è **PARCIAL** (solo valida @PastOrPresent, falta validaci√≥n contra plan)

### RN34 - L√≠mite de Registros Diarios para Prevenir Spam
- **Regla:** Un usuario no puede registrar m√°s de 10 comidas ni m√°s de 10 ejercicios en un mismo d√≠a para prevenir spam/errores.
- **M√≥dulos Afectados:** M√≥dulo 5 (Seguimiento de Progreso)
- **Prioridad:** üü° **MEDIA - INTEGRIDAD**
- **Implementaci√≥n Requerida:**
```java
@Service
public class RegistroComidaService {
    
    private static final int MAX_REGISTROS_DIA = 10;
    
    public void registrarComida(RegistroComidaRequest request, Long perfilUsuarioId) {
        LocalDate fecha = request.getFecha();
        
        // Contar registros existentes para esta fecha
        long registrosHoy = registroComidaRepository
            .countByPerfilUsuarioIdAndFecha(perfilUsuarioId, fecha);
        
        if (registrosHoy >= MAX_REGISTROS_DIA) {
            throw new ValidationException(
                "Has alcanzado el l√≠mite de " + MAX_REGISTROS_DIA 
                + " comidas por d√≠a. Si cometiste un error, elimina un registro anterior."
            );
        }
        
        // Proceder con registro...
    }
}

// Query en Repository
@Query("SELECT COUNT(r) FROM RegistroComida r " +
       "WHERE r.perfilUsuarioId = :perfilUsuarioId " +
       "AND r.fecha = :fecha")
long countByPerfilUsuarioIdAndFecha(
    @Param("perfilUsuarioId") Long perfilUsuarioId, 
    @Param("fecha") LocalDate fecha
);
```
- **Estado:** ‚ùå **NO IMPLEMENTADO**

---

## üì¢ REGLAS DE EXPERIENCIA DE USUARIO

### RN35 - Sistema de Notificaciones de Progreso
- **Regla:** El sistema debe enviar notificaciones al usuario para mantener engagement: recordatorios diarios, celebraci√≥n de logros, alertas de desviaci√≥n de metas.
- **M√≥dulos Afectados:** M√≥dulo 5 (Seguimiento de Progreso)
- **Prioridad:** üü° **MEDIA - UX**
- **Tipos de Notificaciones:**
  - **Recordatorio Diario:** "¬°Recuerda registrar tus comidas de hoy!" (8 AM)
  - **Celebraci√≥n Logro:** "üéâ ¬°Completaste 7 d√≠as seguidos!" (al alcanzar streak)
  - **Alerta Desviaci√≥n:** "‚ö†Ô∏è Hoy consumiste 500 calor√≠as m√°s que tu meta" (al final del d√≠a)
  - **Plan Pr√≥ximo a Completar:** "¬°Te faltan 3 d√≠as para completar tu plan!"
- **Implementaci√≥n Requerida:**
```java
@Service
public class NotificacionService {
    
    @Scheduled(cron = "0 0 8 * * *") // Todos los d√≠as a las 8 AM
    public void enviarRecordatoriosDiarios() {
        List<PerfilUsuario> usuariosActivos = perfilUsuarioRepository
            .findWithPlanesActivos();
        
        for (PerfilUsuario usuario : usuariosActivos) {
            // Verificar si ya registr√≥ algo hoy
            boolean registroHoy = registroComidaRepository
                .existsByPerfilUsuarioIdAndFecha(usuario.getId(), LocalDate.now());
            
            if (!registroHoy) {
                // Enviar notificaci√≥n push/email
                notificationSender.send(usuario.getCuentaAuth().getEmail(),
                    "Recordatorio NutriTrack",
                    "¬°Recuerda registrar tus comidas de hoy! üçé"
                );
            }
        }
    }
    
    public void celebrarLogro(Long perfilUsuarioId, TipoLogro logro) {
        PerfilUsuario usuario = perfilUsuarioRepository.findById(perfilUsuarioId)
            .orElseThrow();
        
        String mensaje = switch (logro) {
            case STREAK_7_DIAS -> "üéâ ¬°Incre√≠ble! Completaste 7 d√≠as seguidos registrando tu progreso.";
            case PLAN_COMPLETADO -> "üèÜ ¬°Felicitaciones! Completaste tu plan nutricional.";
            case META_PESO -> "üéØ ¬°Lograste tu meta de peso! Eres disciplinado.";
            default -> "¬°Gran trabajo en NutriTrack!";
        };
        
        notificationSender.send(usuario.getCuentaAuth().getEmail(),
            "¬°Logro Desbloqueado!", mensaje
        );
    }
}

enum TipoLogro {
    STREAK_7_DIAS, PLAN_COMPLETADO, META_PESO
}
```
- **Estado:** ‚ùå **NO IMPLEMENTADO**

---

## üìä REGLAS DE AUDITOR√çA Y CUMPLIMIENTO

### RN36 - Versionado de Planes para Trazabilidad
- **Regla:** Cuando un usuario activa un plan, el sistema debe crear una copia snapshot (JSON) del contenido del plan en ese momento para preservar el historial incluso si el admin modifica el plan original.
- **M√≥dulos Afectados:** M√≥dulo 4 (Exploraci√≥n y Activaci√≥n)
- **Prioridad:** üü° **MEDIA - AUDITOR√çA**
- **Implementaci√≥n Requerida:**
```java
@Entity
@Table(name = "usuario_planes")
public class UsuarioPlan {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;
    
    // ... otros campos ...
    
    @Column(columnDefinition = "JSONB")
    @Type(JsonBinaryType.class)
    private String planSnapshot; // Copia JSON del plan al momento de activaci√≥n
    
    private Integer versionPlan; // N√∫mero de versi√≥n del plan
}

@Service
public class UsuarioPlanService {
    
    public UsuarioPlan activarPlan(Long perfilUsuarioId, Long planId) {
        Plan plan = planRepository.findById(planId)
            .orElseThrow(() -> new NotFoundException("Plan no encontrado"));
        
        // Crear snapshot JSON del plan
        PlanSnapshotDTO snapshot = new PlanSnapshotDTO();
        snapshot.setNombre(plan.getNombre());
        snapshot.setDescripcion(plan.getDescripcion());
        snapshot.setDuracionDias(plan.getDuracionDias());
        snapshot.setCaloriasDiarias(plan.getCaloriasDiarias());
        snapshot.setComidas(plan.getComidas()); // Incluir todas las comidas
        
        String snapshotJson = objectMapper.writeValueAsString(snapshot);
        
        UsuarioPlan usuarioPlan = new UsuarioPlan();
        usuarioPlan.setPlanId(planId);
        usuarioPlan.setPlanSnapshot(snapshotJson);
        usuarioPlan.setVersionPlan(plan.getVersion()); // Incrementar en cada modificaci√≥n
        usuarioPlan.setEstado(EstadoAsignacion.ACTIVO);
        
        return usuarioPlanRepository.save(usuarioPlan);
    }
}
```
- **Beneficios:**
  - Historial inmutable de qu√© plan exacto sigui√≥ el usuario
  - Auditor√≠a: comparar progreso contra plan original, no contra versi√≥n actual
  - Cumplimiento: evidencia de qu√© se recomend√≥ al usuario
- **Estado:** ‚ùå **NO IMPLEMENTADO**

### RN37 - Exportaci√≥n GDPR de Datos de Usuario
- **Regla:** Un usuario debe poder descargar TODOS sus datos personales en formato portable (JSON/PDF) para cumplir con normativas de protecci√≥n de datos (GDPR, LGPD).
- **M√≥dulos Afectados:** M√≥dulo 1 (Gesti√≥n de Cuentas), Transversal
- **Prioridad:** üî¥ **ALTA - CUMPLIMIENTO LEGAL**
- **Implementaci√≥n Requerida:**
```java
@RestController
@RequestMapping("/api/v1/cuenta")
public class CuentaController {
    
    @GetMapping("/exportar-datos")
    @PreAuthorize("isAuthenticated()")
    public ResponseEntity<ExportacionDatosDTO> exportarDatos(Authentication auth) {
        String email = auth.getName();
        
        ExportacionDatosDTO exportacion = cuentaService.exportarDatosCompletos(email);
        
        return ResponseEntity.ok()
            .header("Content-Disposition", 
                "attachment; filename=nutritrack_datos_" + LocalDate.now() + ".json")
            .body(exportacion);
    }
}

@Service
public class CuentaService {
    
    public ExportacionDatosDTO exportarDatosCompletos(String email) {
        CuentaAuth cuenta = cuentaAuthRepository.findByEmail(email)
            .orElseThrow();
        PerfilUsuario perfil = cuenta.getPerfilUsuario();
        
        ExportacionDatosDTO dto = new ExportacionDatosDTO();
        
        // 1. Datos de cuenta
        dto.setEmail(cuenta.getEmail());
        dto.setRol(cuenta.getRol().name());
        dto.setFechaCreacion(cuenta.getFechaCreacion());
        
        // 2. Datos de perfil
        dto.setPerfil(new PerfilDTO(
            perfil.getNombre(),
            perfil.getApellido(),
            perfil.getFechaNacimiento(),
            perfil.getGenero(),
            perfil.getUnidadesMedida()
        ));
        
        // 3. Etiquetas de salud (objetivos, alergias)
        dto.setEtiquetasSalud(usuarioEtiquetaSaludRepository
            .findByPerfilUsuarioId(perfil.getId()));
        
        // 4. Historial de planes
        dto.setPlanesAsignados(usuarioPlanRepository
            .findByPerfilUsuarioId(perfil.getId()));
        
        // 5. Registros de comidas
        dto.setRegistrosComidas(registroComidaRepository
            .findByPerfilUsuarioId(perfil.getId()));
        
        // 6. Registros de ejercicios
        dto.setRegistrosEjercicios(registroEjercicioRepository
            .findByPerfilUsuarioId(perfil.getId()));
        
        // 7. Historial de mediciones
        dto.setHistorialMediciones(medicionRepository
            .findByPerfilUsuarioId(perfil.getId()));
        
        return dto;
    }
}
```
- **Contenido Exportado:**
  - Datos de cuenta (email, rol, fecha creaci√≥n)
  - Perfil personal (nombre, apellido, fecha nacimiento)
  - Objetivos y alergias
  - Historial completo de planes y rutinas
  - Todos los registros de comidas y ejercicios
  - Historial de mediciones y peso
- **Estado:** ‚ùå **NO IMPLEMENTADO**

---

## ‚ö° REGLAS DE RENDIMIENTO Y ESCALABILIDAD

### RN38 - Cach√© de Consultas de Cat√°logo
- **Regla:** Las consultas de cat√°logo p√∫blico (planes, rutinas, ingredientes, ejercicios) deben estar cacheadas para reducir carga en base de datos.
- **M√≥dulos Afectados:** M√≥dulo 3 (Gestor de Cat√°logo), M√≥dulo 4 (Exploraci√≥n)
- **Prioridad:** üü¢ **BAJA - OPTIMIZACI√ìN**
- **Implementaci√≥n Requerida:**
```java
@Configuration
@EnableCaching
public class CacheConfig {
    
    @Bean
    public CacheManager cacheManager() {
        return new ConcurrentMapCacheManager(
            "planes", "rutinas", "ingredientes", "ejercicios"
        );
    }
}

@Service
public class PlanService {
    
    @Cacheable(value = "planes", key = "'catalogo'", unless = "#result.isEmpty()")
    public List<PlanDTO> verCatalogo() {
        return planRepository.findAllActivosWithComidas();
    }
    
    @CacheEvict(value = "planes", allEntries = true)
    public Plan crearPlan(CrearPlanRequest request) {
        // Crear plan... cache se invalida autom√°ticamente
    }
    
    @CacheEvict(value = "planes", allEntries = true)
    public Plan actualizarPlan(Long id, ActualizarPlanRequest request) {
        // Actualizar plan... cache se invalida
    }
}
```
- **Estrategia:**
  - TTL: 5 minutos para cat√°logos p√∫blicos
  - Invalidaci√≥n: al crear/modificar/eliminar entidad
  - Cach√© por usuario: para cat√°logos personalizados (con filtro de alergias)
- **Estado:** ‚ùå **NO IMPLEMENTADO**

### RN39 - B√∫squeda Full-Text en Cat√°logos
- **Regla:** Los usuarios deben poder buscar planes y rutinas por nombre, descripci√≥n o etiquetas usando b√∫squeda de texto completo.
- **M√≥dulos Afectados:** M√≥dulo 4 (Exploraci√≥n y Activaci√≥n)
- **Prioridad:** üü° **MEDIA - UX**
- **Implementaci√≥n Requerida:**
```java
@Repository
public interface PlanRepository extends JpaRepository<Plan, Long> {
    
    @Query("""
        SELECT DISTINCT p FROM Plan p
        LEFT JOIN p.etiquetas e
        WHERE p.activo = true
        AND (
            LOWER(p.nombre) LIKE LOWER(CONCAT('%', :searchTerm, '%'))
            OR LOWER(p.descripcion) LIKE LOWER(CONCAT('%', :searchTerm, '%'))
            OR LOWER(e.nombre) LIKE LOWER(CONCAT('%', :searchTerm, '%'))
        )
        ORDER BY p.nombre
    """)
    List<Plan> buscarEnCatalogo(@Param("searchTerm") String searchTerm);
}

@RestController
@RequestMapping("/api/v1/planes")
public class PlanController {
    
    @GetMapping("/buscar")
    public ResponseEntity<List<PlanDTO>> buscar(
        @RequestParam String q, // query
        @RequestParam(required = false) String categoria
    ) {
        if (q.length() < 3) {
            throw new ValidationException("B√∫squeda debe tener m√≠nimo 3 caracteres");
        }
        
        List<Plan> resultados = planRepository.buscarEnCatalogo(q);
        
        // Filtrar por categor√≠a si se especifica
        if (categoria != null) {
            resultados = resultados.stream()
                .filter(p -> p.getEtiquetas().stream()
                    .anyMatch(e -> e.getCategoria().equals(categoria)))
                .collect(Collectors.toList());
        }
        
        return ResponseEntity.ok(
            resultados.stream()
                .map(planMapper::toDTO)
                .collect(Collectors.toList())
        );
    }
}
```
- **Caracter√≠sticas:**
  - B√∫squeda case-insensitive
  - B√∫squeda en nombre, descripci√≥n y etiquetas
  - M√≠nimo 3 caracteres para buscar
  - Filtro opcional por categor√≠a de etiqueta
- **Estado:** ‚ùå **NO IMPLEMENTADO**

---

**Fecha de √öltima Actualizaci√≥n:** 5 de Noviembre, 2025  
**Versi√≥n del Documento:** 2.1  
**Cambios en esta Versi√≥n:**
- ‚úÖ **IMPLEMENTADAS:** RN30 (Email RFC 5322 + DNS), RN31 (Contrase√±a 12+ chars + complejidad), RN32 (Validaci√≥n al√©rgenos)
- Sprint 1 de seguridad completado parcialmente (3/5 reglas)
- Cobertura de implementaci√≥n incrementada de 61.5% a 69.2%
- Total: **39 reglas de negocio** (27 implementadas, 12 pendientes)

---

## üìä RESUMEN DE COBERTURA

### Estado de Implementaci√≥n por Prioridad

| Prioridad | Implementadas | No Implementadas | Total |
|-----------|---------------|------------------|-------|
| üö® **Cr√≠tica** | 4 (RN16, RN30, RN31, RN32) | 2 (RN29, RN37) | 6 |
| üî¥ **Alta** | 8 (RN07-RN09, RN14, RN17-RN19) | 1 (RN33) | 9 |
| üü° **Media** | 14 (RN01-RN06, RN10-RN13, RN20-RN23, RN25-RN28) | 3 (RN24, RN34-RN36) | 17 |
| üü¢ **Baja** | 0 | 2 (RN38-RN39) | 2 |
| **TOTAL** | **27/39** (69.2%) | **12/39** (30.8%) | **39** |

### Roadmap de Implementaci√≥n Recomendado

**Sprint 1 - Seguridad (1 semana):** ‚úÖ **COMPLETADO (3/5)**
- ‚ùå RN29: Rate Limiting (4 horas) - PENDIENTE
- ‚úÖ RN30: Validaci√≥n Email con DNS (2 horas) - **COMPLETADO**
- ‚úÖ RN31: Pol√≠tica Contrase√±as Robusta (2 horas) - **COMPLETADO**
- ‚úÖ RN32: Validaci√≥n Cruzada Al√©rgenos (6 horas) - **COMPLETADO**
- ‚ùå RN37: Exportaci√≥n GDPR (6 horas) - PENDIENTE

**Sprint 2 - Integridad (1 semana):**
- ‚ùå RN33: Validaci√≥n L√≥gica Fechas (4 horas)
- ‚ùå RN34: L√≠mites Registros Diarios (3 horas)
- ‚ùå RN36: Versionado de Planes (8 horas)

**Sprint 3 - Experiencia Usuario (1 semana):**
- ‚ùå RN35: Sistema Notificaciones (16 horas)
- ‚ùå RN24: Reporte PDF (8 horas)

**Sprint 4 - Optimizaci√≥n (1 semana):**
- ‚ùå RN38: Cach√© de Cat√°logos (4 horas)
- ‚ùå RN39: B√∫squeda Full-Text (6 horas)

**Total Estimado:** 4 semanas (69 horas de desarrollo)  
**Completado:** 10 horas (14.5%)  
**Pendiente:** 59 horas (85.5%)

---

> **üí° Instrucciones para el Equipo:**  
> - Cada integrante es responsable de implementar las reglas asignadas a su m√≥dulo
> - Las reglas marcadas como üî¥/üö® tienen prioridad m√°xima
> - Antes de marcar una tarea como completada, verificar que cumple EXACTAMENTE con la regla especificada
> - Consultar con el equipo si una regla entra en conflicto con otra funcionalidad
> - **Las nuevas reglas RN29-RN39 son recomendaciones para alcanzar calidad de producci√≥n del 100%**
